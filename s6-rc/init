#!/bin/execlineb -P

# init

/bin/export PATH "/usr/bin:/bin:/usr/sbin:/sbin"
/bin/cd /
s6-setsid -qb --
umask 022
if { s6-echo -- "\n  Welcome to MLFS with S6" }
if { s6-echo -- "\n  init created by s6-linux-init-maker\n  see http://skarnet.org/software/s6-linux-init/\n\n" }
if { s6-echo -- "[ Stage 1 ] Loading ...\n" }
if { s6-mount -nwt tmpfs -o mode=0755 tmpfs /run }
if { /etc/s6-rc/scripts/load-clock }
if { s6-mkdir /run/boot }
if { s6-hiercopy /etc/s6-rc/run-image /run/boot }
emptyenv -p
s6-envdir -I -- /etc/s6-rc/env
redirfd -r 0 /dev/null
redirfd -wnb 1 /run/boot/service/s6-svscan-log/fifo
background
{
  s6-setsid --
  redirfd -w 1 /run/boot/service/s6-svscan-log/fifo
  fdmove -c 2 1
  if { s6-echo -- "[ Stage 1 ] Complete.\n" }
  if { /etc/s6-rc/stage2 }
}
unexport !
cd /run/boot/service
fdmove -c 2 1
s6-svscan -st0
