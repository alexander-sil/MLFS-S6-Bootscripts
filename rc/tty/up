#!/bin/execlineb -P

fdmove -c 2 1
if { s6-echo -- [ >>>> ] tty started }
importas -i S6CONF S6CONF
s6-envdir ${S6CONF}
importas -D "" TTY TTY
foreground {
        forbacktickx index { seq ${TTY} }
        importas -i index index
        if { mkdir -p /run/service/tty${index} }
        foreground {
                redirfd -a 1 /run/service/tty${index}/run
                s6-echo --
"#!/bin/bash
/usr/bin/agetty -J 38400 tty${index}"
         }
        s6-chmod 0755 /run/service/tty${index}/run
        s6-echo -- [ ok ] tty${index}
}
if { s6-svscanctl -an /run/service }
s6-echo -- [ DONE ] tty successfully started
