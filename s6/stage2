#!/bin/execlineb -P
# stage2

s6-envdir -if /etc/s6/env

foreground {
 if { s6-echo -- "\n[     Stage 2    ]  Loading ...\n" }
 # create user-services  directory
 #install -m755 -g 19 -o 19 -d /run/userv
}

if -nt {
 #Start services...
 if { s6-rc-init -l /run/boot/rc -c /etc/s6/db/current /run/boot/service }
 if { s6-rc -l /run/boot/rc -u change All }
 if { s6-echo -- "\n[     Stage 2    ] Complete.\n" } 
}
redirfd -r 0 /dev/console
redirfd -w 1 /dev/console
fdmove -c 2 1
foreground {
 if { s6-echo -- "[     Stage 2    ]  F A I L E D !\n" }
 if { s6-echo -- "Something wrong on stage2, please see the log at /run/boot/uncaught-logs/current to debug it.\n" }
 if { s6-echo -- "You may need to remount / as rw." }
 # Eventualy run consoles bundle when default fails
}
/bin/bash -i
